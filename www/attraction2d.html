<!DOCTYPE html><html><head><title>my title</title><link rel="stylesheet" href="stylesheets/style.css"></head><body><div id="example-container" class="pjs"><canvas id="myCanvas"></canvas></div><script src="https://raw.github.com/hapticdata/toxiclibsjs/develop/build/toxiclibs.min.js"></script><script src="javascripts/processing.js"></script><script type="application/processing" data-processing-target="myCanvas">//#Attraction2D
//- original example by [Karsten Schmidt](http://postspectacular.com)
//- toxiclibs.js by [Kyle Phillips](http://haptic-data.com)

//This example demonstrates how to use the behavior handling and specifically
//the attraction behavior to create forces around the current locations of
//particles in order to attract (or deflect) other particles nearby.
//
//Behaviors can be added and removed dynamically on both a
//global level (for the entire physics simulation) as well as for
//individual particles only.
//
//**Usage:** Click and drag mouse to attract particles


/* 
 * Copyright (c) 2010 Karsten Schmidt
 * 
 * This demo & library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 * 
 * http://creativecommons.org/licenses/LGPL/2.1/
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 * 
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 */

 var  VerletPhysics2D = toxi.physics2d.VerletPhysics2D,
      VerletParticle2D = toxi.physics2d.VerletParticle2D,
      AttractionBehavior = toxi.physics2d.behaviors.AttractionBehavior,
      GravityBehavior = toxi.physics2d.behaviors.GravityBehavior,
      Vec2D = toxi.geom.Vec2D,
      Rect = toxi.geom.Rect;


//**Everything below here will still work in Processing**
import toxi.geom.*;
import toxi.physics2d.*;
import toxi.physics2d.behaviors.*;

int NUM_PARTICLES = 250;

VerletPhysics2D physics;
AttractionBehavior mouseAttractor;

Vec2D mousePos;

void setup() {
  size(800, 382);
  // setup physics with 5% drag
  physics = new VerletPhysics2D();
  physics.setDrag(0.05);
  physics.setWorldBounds(new Rect(0, 0, width, height));
  // the NEW way to add gravity to the simulation, using behaviors
  physics.addBehavior(new GravityBehavior(new Vec2D(0, 0.15)));
}

void addParticle() {
 Vec2D randLoc = Vec2D.randomVector().scale(5).addSelf(width / 2, 0);
  VerletParticle2D p = new VerletParticle2D(randLoc);
  physics.addParticle(p);
  // add a negative attraction force field around the new particle
  physics.addBehavior(new AttractionBehavior(p, 20, -1.2, 0.01));
}

void draw() {
  background(255,0,0);
  noStroke();
  fill(255);
  if (physics.particles.length < NUM_PARTICLES) {
    addParticle();
  }
  physics.update();
  for (int i=0;i<physics.particles.length;i++) {
  	VerletParticle2D p = physics.particles[i];
    ellipse(p.x, p.y, 5, 5);
  }
 
  
}

void mousePressed() {
  addParticle();
  mousePos = new Vec2D(mouseX, mouseY);
  // create a new positive attraction force field around the mouse position (radius=250px)
  mouseAttractor = new AttractionBehavior(mousePos, 250, 0.9);
  physics.addBehavior(mouseAttractor);
}

void mouseDragged() {
  // update mouse attraction focal point
  mousePos.set(mouseX, mouseY);
}

void mouseReleased() {
  // remove the mouse attraction when button has been released
  physics.removeBehavior(mouseAttractor);
}</script><nav id="navigation"><ul><li><a href="#">Toxiclibs.js</a></li><li><a href="#">Examples</a></li><li>This Example:<ul><li><a href="#">Annotated Source</a></li><li><a href="#">Live Editor</a></li></ul></li></ul></nav><section id="pagelet">  <div id="container">     <div id="background"></div>            <!--div id="jump_to">         <a href="http://haptic-data.com/toxiclibsjs">Toxiclibs.js</a> > Examples &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="additiveWaves.html">                 additiveWaves.js               </a>                                           <a class="source" href="arcPolarCoordinates.html">                 arcPolarCoordinates.js               </a>                                           <a class="source" href="attraction2d.html">                 attraction2d.js               </a>                                           <a class="source" href="circle3Points.html">                 circle3Points.js               </a>                                           <a class="source" href="draggableParticles_pjs.html">                 draggableParticles_pjs.js               </a>                                           <a class="source" href="line2dIntersection.html">                 line2dIntersection.js               </a>                                           <a class="source" href="meshDoodle.html">                 meshDoodle.js               </a>                                           <a class="source" href="perlinNoiseCanvas.html">                 perlinNoiseCanvas.js               </a>                                           <a class="source" href="polarLinesPjs.html">                 polarLinesPjs.js               </a>                                           <a class="source" href="softBodySquare.html">                 softBodySquare.js               </a>                                           <a class="source" href="superEllipsoid.html">                 superEllipsoid.js               </a>                                           <a class="source" href="terrainNoise.html">                 terrainNoise.js               </a>                                           <a class="source" href="thread.html">                 thread.js               </a>                                           <a class="source" href="wheelInsets.html">                 wheelInsets.js               </a>                        </div>         </div>       </div-->          <table cellpadding="0" cellspacing="0">       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h1>Attraction2D</h1>

<ul>
<li>original example by <a href="http://postspectacular.com">Karsten Schmidt</a></li>
<li>toxiclibs.js by <a href="http://haptic-data.com">Kyle Phillips</a></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>This example demonstrates how to use the behavior handling and specifically
the attraction behavior to create forces around the current locations of
particles in order to attract (or deflect) other particles nearby.</p>

<p>Behaviors can be added and removed dynamically on both a
global level (for the entire physics simulation) as well as for
individual particles only.</p>

<p><strong>Usage:</strong> Click and drag mouse to attract particles</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/* </span>
<span class="cm"> * Copyright (c) 2010 Karsten Schmidt</span>
<span class="cm"> * </span>
<span class="cm"> * This demo &amp; library is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU Lesser General Public</span>
<span class="cm"> * License as published by the Free Software Foundation; either</span>
<span class="cm"> * version 2.1 of the License, or (at your option) any later version.</span>
<span class="cm"> * </span>
<span class="cm"> * http://creativecommons.org/licenses/LGPL/2.1/</span>
<span class="cm"> * </span>
<span class="cm"> * This library is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * Lesser General Public License for more details.</span>
<span class="cm"> * </span>
<span class="cm"> * You should have received a copy of the GNU Lesser General Public</span>
<span class="cm"> * License along with this library; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span>
<span class="cm"> */</span>

 <span class="kd">var</span>  <span class="nx">VerletPhysics2D</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="nx">VerletPhysics2D</span><span class="p">,</span>
      <span class="nx">VerletParticle2D</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="nx">VerletParticle2D</span><span class="p">,</span>
      <span class="nx">AttractionBehavior</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="nx">behaviors</span><span class="p">.</span><span class="nx">AttractionBehavior</span><span class="p">,</span>
      <span class="nx">GravityBehavior</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="nx">behaviors</span><span class="p">.</span><span class="nx">GravityBehavior</span><span class="p">,</span>
      <span class="nx">Vec2D</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">geom</span><span class="p">.</span><span class="nx">Vec2D</span><span class="p">,</span>
      <span class="nx">Rect</span> <span class="o">=</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">geom</span><span class="p">.</span><span class="nx">Rect</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p><strong>Everything below here will still work in Processing</strong></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kr">import</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">geom</span><span class="p">.</span><span class="o">*</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="o">*</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">toxi</span><span class="p">.</span><span class="nx">physics2d</span><span class="p">.</span><span class="nx">behaviors</span><span class="p">.</span><span class="o">*</span><span class="p">;</span>

<span class="kr">int</span> <span class="nx">NUM_PARTICLES</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span>

<span class="nx">VerletPhysics2D</span> <span class="nx">physics</span><span class="p">;</span>
<span class="nx">AttractionBehavior</span> <span class="nx">mouseAttractor</span><span class="p">;</span>

<span class="nx">Vec2D</span> <span class="nx">mousePos</span><span class="p">;</span>

<span class="k">void</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">size</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">382</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>setup physics with 5% drag</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">physics</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VerletPhysics2D</span><span class="p">();</span>
  <span class="nx">physics</span><span class="p">.</span><span class="nx">setDrag</span><span class="p">(</span><span class="mf">0.05</span><span class="p">);</span>
  <span class="nx">physics</span><span class="p">.</span><span class="nx">setWorldBounds</span><span class="p">(</span><span class="k">new</span> <span class="nx">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>the NEW way to add gravity to the simulation, using behaviors</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">physics</span><span class="p">.</span><span class="nx">addBehavior</span><span class="p">(</span><span class="k">new</span> <span class="nx">GravityBehavior</span><span class="p">(</span><span class="k">new</span> <span class="nx">Vec2D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)));</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">addParticle</span><span class="p">()</span> <span class="p">{</span>
 <span class="nx">Vec2D</span> <span class="nx">randLoc</span> <span class="o">=</span> <span class="nx">Vec2D</span><span class="p">.</span><span class="nx">randomVector</span><span class="p">().</span><span class="nx">scale</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="nx">addSelf</span><span class="p">(</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="nx">VerletParticle2D</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VerletParticle2D</span><span class="p">(</span><span class="nx">randLoc</span><span class="p">);</span>
  <span class="nx">physics</span><span class="p">.</span><span class="nx">addParticle</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>add a negative attraction force field around the new particle</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">physics</span><span class="p">.</span><span class="nx">addBehavior</span><span class="p">(</span><span class="k">new</span> <span class="nx">AttractionBehavior</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">background</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="nx">noStroke</span><span class="p">();</span>
  <span class="nx">fill</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">physics</span><span class="p">.</span><span class="nx">particles</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">NUM_PARTICLES</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">addParticle</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">physics</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kr">int</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">physics</span><span class="p">.</span><span class="nx">particles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">VerletParticle2D</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">physics</span><span class="p">.</span><span class="nx">particles</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">ellipse</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">p</span><span class="p">.</span><span class="nx">y</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
  <span class="p">}</span>
 
  
<span class="p">}</span>

<span class="k">void</span> <span class="nx">mousePressed</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">addParticle</span><span class="p">();</span>
  <span class="nx">mousePos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vec2D</span><span class="p">(</span><span class="nx">mouseX</span><span class="p">,</span> <span class="nx">mouseY</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>create a new positive attraction force field around the mouse position (radius=250px)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">mouseAttractor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AttractionBehavior</span><span class="p">(</span><span class="nx">mousePos</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">);</span>
  <span class="nx">physics</span><span class="p">.</span><span class="nx">addBehavior</span><span class="p">(</span><span class="nx">mouseAttractor</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">mouseDragged</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>update mouse attraction focal point</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">mousePos</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">mouseX</span><span class="p">,</span> <span class="nx">mouseY</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nx">mouseReleased</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>remove the mouse attraction when button has been released</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">physics</span><span class="p">.</span><span class="nx">removeBehavior</span><span class="p">(</span><span class="nx">mouseAttractor</span><span class="p">);</span>
<span class="p">}</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div></section><footer></footer></body></html>